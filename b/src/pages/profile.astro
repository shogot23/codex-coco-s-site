---
import { getCollection } from 'astro:content';
import Layout from '../layouts/Layout.astro';

const base = import.meta.env.BASE_URL;
const profileCollection = await getCollection('profile');
const profile = profileCollection[0];
const avatarPath = profile?.data.avatar ?? '/uploads/avatar-placeholder.png';
const avatarSrc = avatarPath.startsWith(base)
  ? avatarPath
  : `${base}${avatarPath.replace(/^\/+/, '')}`;
---

<Layout title="Profile">
  <section class="card profile">
    <h2>Profile</h2>
    <img src={avatarSrc} alt="プロフィール画像" width="96" height="96" />
    <p>avatar: <code>{avatarPath}</code></p>
  </section>
</Layout>

<style>
  .profile {
    display: grid;
    gap: 0.8rem;
    justify-items: start;
  }

  img {
    width: 96px;
    height: 96px;
    border-radius: 9999px;
    object-fit: cover;
    border: 1px solid var(--line);
    background: #fff;
  }

  p {
    margin: 0;
    color: var(--muted);
  }
</style>
